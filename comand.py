import asyncio
import logging

from aiogram.enums import ChatMemberStatus
from aiogram.exceptions import TelegramAPIError
from aiogram.filters import Command
from aiogram.types import InputFile, FSInputFile, InputMediaPhoto, InputMediaVideo
from keyboard import order, inline_kb
from const import *
from aiogram import Bot, Dispatcher, Router, types
from database import add_or_update_user, get_all_users_with_block_status, save_users_to_csv, mark_user_blocked
from aiogram.types import ChatMemberUpdated


@router.message(Command("start"))
async def start(message: types.Message):
    """–û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /start"""
    messag = """–ü—Ä–∏–≤—ñ—Ç! –ú–µ–Ω–µ –∑–≤–∞—Ç–∏ –Æ–ª—ñ—è, —è ‚Äî –µ–∫—Å–ø–µ—Ä—Ç –∑ –∑–∞–ª—É—á–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –≤ –Ü–Ω—Å—Ç–∞–≥—Ä–∞–º.

<a href="https://www.instagram.com/_a_s_t_e_r_i_/">_a_s_t_e_r_i_</a>

–ú–æ—ó —É—á–Ω—ñ —Ç–∞ –∫–ª—ñ—î–Ω—Ç–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å <u>–ø–µ—Ä—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —á–µ—Ä–µ–∑ 5-7 –¥–Ω—ñ–≤ –ø—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ—î—ó —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó.</u>

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ —è –¥–∞—é –≤—Å–µ, —â–æ–± –≤–∏ –º–æ–≥–ª–∏ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–≤—á–∏—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª —ñ –¥–æ—Å—è–≥—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —à–≤–∏–¥–∫–æ:

<b>‚Ä¢ –£—Ä–æ–∫ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ç–∞ –∑–∞–ª—É—á–µ–Ω–Ω—é —Ç—Ä–∞—Ñ—ñ–∫—É</b>
<b>‚Ä¢ –ü—Ä–∏–∫–ª–∞–¥–∏ –ø—Ä–∞—Ü—é—é—á–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π –¥–ª—è —ñ–Ω—Å—Ç–∞–≥—Ä–∞–º-–º–∞–≥–∞–∑–∏–Ω—ñ–≤ —Ç–∞ –µ–∫—Å–ø–µ—Ä—Ç—ñ–≤</b>

–í–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –º–µ–Ω—à–µ –≥–æ–¥–∏–Ω–∏ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É —ñ –º–∞–∫—Å–∏–º—É–º —Ç–∏–∂–¥–µ–Ω—å –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó, —è–∫—â–æ –≤–∞—à –ø—Ä–æ–¥—É–∫—Ç —É–∂–µ —î, –∞ –∞–∫–∞—É–Ω—Ç —É–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ç–∞ –º–æ–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –Ω–æ–≤—É –∞—É–¥–∏—Ç–æ—Ä—ñ—é.
–ü–æ—á–∏–Ω–∞–π—Ç–µ! üëáüèª
"""
    add_or_update_user(message.from_user.id, message.from_user.username, "/start", 0)
    await bot.send_message(message.chat.id, messag, parse_mode="HTML")

    # –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤—ñ–¥–µ–æ
    thumbnail = FSInputFile("IMG_8227.PNG")
    await bot.send_video(message.chat.id, video=FILE_ID, thumbnail=thumbnail)

    # –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä–∏ —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ
    asyncio.create_task(delayed_messages(chat_id=message.from_user.id, username=message.from_user.username))


# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
async def get_user_stats():
    """–ü–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö —Ç–∞ –Ω–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö"""
    users_with_status = get_all_users_with_block_status()  # –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ —ó—Ö —Å—Ç–∞—Ç—É—Å–æ–º
    blocked_count = 0
    unblocked_count = 0

    for user in users_with_status:
        if user['blocked_status'] == "–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ":
            blocked_count += 1
        else:
            unblocked_count += 1

    stats = f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:\n"
    stats += f"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: {len(users_with_status)}\n"
    stats += f"–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ: {blocked_count}\n"
    stats += f"–ù–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ: {unblocked_count}\n"

    return stats


# –û–±—Ä–æ–±–∫–∞ –∫–æ–º–∞–Ω–¥–∏ /stats u
@router.message(Command('stats_u'))
async def cmd_stats(message: types.Message):
    """–û–±—Ä–æ–±–ª—è—î –∫–æ–º–∞–Ω–¥—É /stats —Ç–∞ –≤–∏–≤–æ–¥–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"""
    stats = await get_user_stats()  # –û—Ç—Ä–∏–º—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

    # –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV

    # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ –∑ —ñ–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫–æ—é
    await message.answer(stats, reply_markup=inline_kb)


# –û–±—Ä–æ–±–∫–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ —ñ–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV
@router.callback_query(lambda c: c.data == 'download_csv')
async def download_csv(callback_query: types.CallbackQuery):
    """–û–±—Ä–æ–±–ª—è—î –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ —ñ–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è CSV"""
    file_path = save_users_to_csv()  # –ì–µ–Ω–µ—Ä—É—î–º–æ CSV —Ñ–∞–π–ª
    document = FSInputFile(file_path)  # –æ–±–≥–æ—Ä—Ç–∞—î–º–æ —à–ª—è—Ö
    await bot.send_document(callback_query.from_user.id, document, caption="–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç—ñ CSV")

    # –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏
    await callback_query.answer("–§–∞–π–ª CSV –≥–æ—Ç–æ–≤–∏–π –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è!")


async def delayed_messages(chat_id: int, username):
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —ñ–∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é"""
    await asyncio.sleep(7200)
    try:
        await bot.send_photo(
            chat_id,
            photo=FSInputFile("2.jpg"),
            caption="""–Ø–∫—â–æ –í–∏ —Ö–æ—á–µ—Ç–µ –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏ —Å–≤—ñ–π —Ä—ñ—Å—Ç, –Ø –º–æ–∂—É –¥–æ–ø–æ–º–æ–≥—Ç–∏ –í–∞–º —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—å –Ω–∞ –æ—Å–æ–±–∏—Å—Ç—ñ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –¥–ª—è –í–∞—Å –≤–æ—Ä–æ–Ω–∫—É –≤ –í–∞—à –∞–∫–∞—É–Ω—Ç\.
    
    –ü—Ä–æ—Ö–æ–¥–∏—Ç—å —É —Ç–∞–∫–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ\:
    
    ‚Ä¢ —è –ø—Ä–∏—Å–∏–ª–∞—é –í–∞–º —É—Ä–æ–∫ —É –∑–∞–ø–∏—Å—ñ –ø–æ –∑–≤'—è–∑—Ü—ñ —Ç–∞ –∑–∞–ª—É—á–µ–Ω–Ω—é —Ç—Ä–∞—Ñ—ñ–∫–∞ üëÜ–ø–æ–¥–∏–≤—ñ—Ç—å—Å—è üíµ  
    ‚Ä¢ –ø—ñ—Å–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø—Ä–∏–∑–Ω–∞—á–∞—î–º–æ –¥–∞—Ç—É, —ñ —É –Ω–∞—Å –∑ –í–∞–º–∏ –≤—ñ–¥–µ–æ\-—Å–µ—Å—ñ—è *1,5 –≥–æ–¥–∏–Ω–∏*, –Ω–∞ —è–∫—ñ–π\:  
    ‚ó¶ —è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é –Ω–∞ –í–∞—à—ñ –ø–∏—Ç–∞–Ω–Ω—è –ø–æ —Ç–µ–º—ñ —É—Ä–æ–∫—É, —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ —Å–∞–º–æ–≥–æ —Ä–∏–ª—Å–∞ —ñ —Ä–µ–∫–ª–∞–º—ñ  
    ‚ó¶ —Ä–æ–±–ª—é —Ä–æ–∑–±—ñ—Ä, –∑ —è–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑—É—î–º–æ –ø—ñ–¥ –í–∞—Å —ñ —Ä–æ–±–∏–º–æ *2\-3 —Ç—Ä–∏–≥–µ—Ä—è—â–∏—Ö –æ—Ñ—Ñ–µ—Ä–∞*, –∑–∞–ª–∏—à–∏—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤–ø–∏—Å–∞—Ç–∏ —ó—Ö —É —Å–≤–æ—ó —Ä–∏–ª—Å–∏  
    ‚ó¶ —Ä–æ–∑–±—ñ—Ä –í–∞—à–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ—ó –ª—ñ–Ω—ñ–π–∫–∏  
    ‚ó¶ —Å–∫–ª–∞–¥–∞—é *–≤–æ—Ä–æ–Ω–∫—É* –ø—ñ–¥ –í–∞—à—ñ –ø—Ä–æ–¥—É–∫—Ç–∏  
    ‚ó¶ –Ø–∫—â–æ —É –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–æ–¥—É–∫—Ç—ñ–≤, —Ä–æ–∑–ø–æ–≤—ñ–º —è–∫ —ó—Ö —Å—Ç–≤–æ—Ä–∏—Ç–∏ —É –±—É–¥—å\-—è–∫—ñ–π –Ω—ñ—à—ñ –∞–±–æ –Ω–∞–¥–∞–º –í–∞–º –≥–æ—Ç–æ–≤–∏–π –ø—Ä–æ–¥—É–∫—Ç  
    ‚ó¶ *7 –¥–Ω—ñ–≤ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É* –ø—ñ—Å–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó  
    
    –í–∞—Ä—Ç—ñ—Å—Ç—å –æ—Å–æ–±–∏—Å—Ç–æ—ó –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó *1,5 –≥–æ–¥–∏–Ω–∏* \+ —Ä–æ–∑—Ä–æ–±–∫–∞ *2\-3 –≤–æ—Ä–æ–Ω–æ–∫* **150$**  
     *–Ñ —Ä–æ–∑—Å—Ç—Ä–æ—á–∫–∏ –¥–æ 25 –º—ñ—Å—è—Ü—ñ–≤, –ø–µ—Ä—à–∏–π –ø–ª–∞—Ç—ñ–∂ —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ –º—ñ—Å—è—Ü—å\!*  üî•
    """,
            reply_markup=order,
            parse_mode="MarkdownV2",
        )
        add_or_update_user(chat_id, username, "2", 0)

        await asyncio.sleep(3600)
        await asyncio.sleep(10)  # 3 —Ö–≤–∏–ª–∏–Ω–∏
        await bot.send_photo(
            chat_id,
            photo=FSInputFile("3.jpg"),
            caption="""–©–æ–± –∑–∞—Ä–æ–±–∏—Ç–∏ <b><u>–ø–µ—Ä—à—ñ —Ç–∏—Å—è—á—ñ —î–≤—Ä–æ</u></b> –Ω–∞ –º–æ—ó–π –∑–≤'—è–∑—Ü—ñ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∑–Ω–∞—Ç–∏, —â–æ –≤—Å–µ, —â–æ –í–∏ —Ä–æ–±–∏–ª–∏ –¥–æ —Ü—å–æ–≥–æ, –Ω–µ –ø—Ä–∞—Ü—é—î.
    
    ‚ùå <i>–Ω—ñ –∑–∞–ø—É—Å–∫–∏ –∑ –ø—Ä–æ–≥—Ä–∞–º–∞–º–∏</i>,  
    ‚ùå <i>–Ω—ñ —â–æ–¥–µ–Ω–Ω—ñ reels —ñ stories</i>,  
    ‚ùå <i>–Ω—ñ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –ø—Ä–æ–¥–∞–∂—ñ –Ω–∞ –≤–∏–≥–æ—Ä—ñ–ª—É –∞—É–¥–∏—Ç–æ—Ä—ñ—é</i>,  
    ‚ùå <i>–Ω—ñ –≤—Å–µ —Ç–µ, —â–æ –í–∏ —Ä–æ–±–∏–ª–∏ "–¥–æ"</i>.
    
    üü¢ <i>–Ø–ö–©–û –•–û–ß–ï–¢–ï –ó–†–û–ë–ò–¢–ò –ù–û–í–ò–ô –†–ò–í–û–ö ‚Äî –ü–û–¢–†–Ü–ë–ù–û –†–û–ë–ò–¢–ò –ü–û-–ù–û–í–û–ú–£, –ù–ï –¢–ê–ö, –Ø–ö –£ –í–ê–° –ë–£–õ–û –†–ê–ù–Ü–®–ï!</i>  
    
    ‚úÖ <i>–í—Å–µ, —â–æ –í–ê–ú –ø–æ—Ç—Ä—ñ–±–Ω–æ ‚Äî <b><u>–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –º–æ—é –∑–≤'—è–∑–∫—É —Å–æ–±—ñ</u></b>, –≤–æ–Ω–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑:</i>  
    ‚û° <i>–¢–†–ê–§–Ü–ö–£ –ü–û –ú–û–á–ô –°–ò–°–¢–ï–ú–Ü + –ê–í–¢–û–í–û–†–û–ù–ö–ò + –ê–í–¢–û–ú–ê–¢–ò–ß–ù–û–á –û–ë–†–û–ë–ö–ò –ó–ê–Ø–í–û–ö –ß–ï–†–ï–ó –ß–ê–¢-–ë–û–¢–ê.</i>
    
    –Ø –Ω–∞–¥–∞—é <u>–¥–æ—Å—Ç—É–ø –¥–æ –º–æ—ó—Ö —Ñ–∞—Ö—ñ–≤—Ü—ñ–≤, —è–∫—ñ –∑—Ä–æ–±–ª—è—Ç—å —É—Å—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –í–∞—Å –∑–∞ 7 –¥–Ω—ñ–≤</u> —Ç–∞ –í–∏ –∑–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä—à—ñ –ø—Ä–∏–±—É—Ç–∫–∏ –º–∏—Ç—Ç—î–≤–æ.
    
    –ú–∏ –≤–∏—Ä—ñ—à—É—î–º–æ —É—Å—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è ‚Äî —Ä–æ–∑—Ä–æ–±–∫–∞ –≤–æ—Ä–æ–Ω–æ–∫ –ø—ñ–¥ –í–∞—Å –∑–∞ <i>150$</i>, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–æ—Ç—ñ–≤ –≤—ñ–¥ <i>250$</i> —Ç–∞ –Ω–∞–¥–∞—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ —Ç—Ä–∞—Ñ—ñ–∫—É.
    
    <i>–Ñ —Ä–æ–∑—Å—Ç—Ä–æ—á–∫–∏ –¥–æ 25 –º—ñ—Å—è—Ü—ñ–≤, –ø–µ—Ä—à–∏–π –ø–ª–∞—Ç—ñ–∂ —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ –º—ñ—Å—è—Ü—å!</i>üî•
    """,
            reply_markup=order,
            parse_mode="HTML",  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HTML —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
        )
        add_or_update_user(chat_id, username, "3", 0)

        await asyncio.sleep(3600)

        await bot.send_message(
            chat_id,
            text="""–Ø–∫—â–æ —É –í–∞—Å —î –ø—Ä–æ–¥—É–∫—Ç ‚Äî –∫—É—Ä—Å–∏, —Ç–æ–≤–∞—Ä–∏, –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó, –º–∞—Ä–∞—Ñ–æ–Ω–∏, —Ñ—Ä–∞–Ω—à–∏–∑–∏, –ø–æ—Å–ª—É–≥–∏ ‚Äî —ñ –í–∏ —Ö–æ—á–µ—Ç–µ –ø–æ—á–∞—Ç–∏ –∑–∞—Ä–æ–±–ª—è—Ç–∏ –º–∏—Ç—Ç—î–≤–æ, —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—è <b>–ø–æ–≤–Ω–∏–º —Å—É–ø—Ä–æ–≤–æ–¥–æ–º –≤—ñ–¥ –º–æ—î—ó –∫–æ–º–∞–Ω–¥–∏.</b>
    
    –Ø –ø—Ä–æ–ø–æ–Ω—É—é <b>–∑—Ä–æ–±–∏—Ç–∏ –≤–µ—Å—å –≤–∞—à –∑–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑–∞ –≤–∞—Å</b>, —Ç—ñ–ª—å–∫–∏ –≤ Instagram –∞–±–æ –≤ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –∑ —Å–∞–π—Ç–æ–º –ø—ñ–¥ –≤–∞—à –±—ñ–∑–Ω–µ—Å, —Å–∞–π—Ç–æ–º –µ–∫—Å–ø–µ—Ä—Ç–∞. –¶–µ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ:  
        ‚Ä¢  –ü–æ—á–∞—Ç–∏ –∑–∞—Ä–æ–±–ª—è—Ç–∏ —à–≤–∏–¥–∫–æ  
        ‚Ä¢  –ú–æ–Ω–µ—Ç–∏–∑—É–≤–∞—Ç–∏ –∞—É–¥–∏—Ç–æ—Ä—ñ—é  
        ‚Ä¢  –û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø—Ä–∏–ø–ª–∏–≤ –Ω–æ–≤–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤
    """,
            parse_mode="HTML"  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HTML —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
        )

        await bot.send_message(
            chat_id,
            """<b>–î–∞–≤–∞–π—Ç–µ –Ω–∞–ª–∞—à—Ç—É—î–º–æ –í–∞–º —Ç—Ä–∞—Ñ—ñ–∫ –∑–∞ –í–∞—Å!</b>
    
        <b>–©–æ –≤—Ö–æ–¥–∏—Ç—å:</b>  
        
        ‚Ä¢ –û—Å–æ–±–∏—Å—Ç–∏–π —Ä–æ–∑–±—ñ—Ä –≤–∞—à–æ–≥–æ –±—ñ–∑–Ω–µ—Å—É  
        ‚Ä¢ –†–æ–∑—Ä–æ–±–∫–∞ 3‚Äì5 –≤–æ—Ä–æ–Ω–æ–∫  
        ‚Ä¢ –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞ –º–æ–Ω—Ç–∞–∂ —Ä–µ–∫–ª–∞–º–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤  
        ‚Ä¢ –ó–±—ñ—Ä–∫–∞ —Ç–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∞  
        ‚Ä¢ –ü–æ–±—É–¥–æ–≤–∞ —Ç—É–Ω–µ–ª—ñ–≤ –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑ –ø—Ä–æ–ø–∏—Å–∞–Ω–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏  
        ‚Ä¢ –°–ø–∏—Å–æ–∫ –¥–∂–µ—Ä–µ–ª —Ç—Ä–∞—Ñ—ñ–∫—É : –±–ª–æ–≥–µ—Ä–∏, —Ç–∞—Ä–≥–µ—Ç, —Ä–æ–∑—Å–∏–ª–∫–∏   
        ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è  
    
        –ù–∞–¥ –ø—Ä–æ—î–∫—Ç–æ–º –ø—Ä–∞—Ü—é—î <b>4 —Ñ–∞—Ö—ñ–≤—Ü—ñ</b>
    
        <b>–¶—ñ–Ω–∞: 1000$</b>  
        
        –ú–æ—ó –∫–ª—ñ—î–Ω—Ç–∏ <b>–∑–∞—Ä–æ–±–ª—è—é—Ç—å –∑ —Ü—ñ—î—ó –º–µ—Ç–æ–¥–∏–∫–∏ –≤—ñ–¥ 5.000 –¥–æ 12 000$ –Ω–∞ –º—ñ—Å—è—Ü—å.</b>
    
        –ù–∞ –≤—Å—ñ –º–æ—ó –ø–æ—Å–ª—É–≥–∏ —î —Ä–æ–∑—Å—Ç—Ä–æ—á–∫–∞ –¥–æ 25 –ø–ª–∞—Ç–µ–∂—ñ–≤, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∞—à –±—ñ–∑–Ω–µ—Å –º–æ–∂–µ –æ–±—Ö–æ–¥–∏—Ç–∏—Å—è –≤–∞–º –≤—ñ–¥ 40$ –¥–æ 80$ –Ω–∞ –º—ñ—Å—è—Ü—å, –∞ –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ø–æ –∫—ñ–ª—å–∫–∞ —Ç–∏—Å—è—á $$$$ –æ–¥—Ä–∞–∑—É!
        """,
            reply_markup=order,
            parse_mode="HTML"  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HTML —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
        )
        add_or_update_user(chat_id, username, "4", 0)

        await asyncio.sleep(3600)

        media = [
            InputMediaPhoto(media=FSInputFile("7.jpg")),
            InputMediaPhoto(media=FSInputFile("8.jpg")),
            InputMediaPhoto(media=FSInputFile("9.jpg")),
            InputMediaPhoto(media=FSInputFile("10.jpg")),
            InputMediaPhoto(media=FSInputFile("5.jpg")),
            InputMediaPhoto(media=FSInputFile("6.jpg")),
            InputMediaPhoto(media=FSInputFile("photo_2025-04-04_14-59-28.jpg")),
            InputMediaVideo(media=FSInputFile("IMG_8235.MP4")),
            InputMediaVideo(media=FSInputFile("IMG_8260.MOV")),
        ]

        # –î–æ–¥–∞—î–º–æ caption –¥–æ –∫–æ–∂–Ω–æ–≥–æ –º–µ–¥—ñ–∞—Ñ–∞–π–ª—É
        media[0].caption = """
    <strong>–ö–µ–π—Å: –ø—Ä–æ–¥–∞–∂ –∫—É—Ä—Å—ñ–≤ –∑ –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å—Ç–≤–∞. –Ø–∫ –º–∏ –∑–∞—Ä–æ–±–ª—è–ª–∏ –¥–æ 500 ‚Ç¨ –Ω–∞ –¥–µ–Ω—å –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞</strong>
    –ó–∞—Å—Ç–æ—Å—É–≤–∞–ª–∏ <u>–º–æ—é –º–µ—Ç–æ–¥–∏–∫—É –∑ –∑–∞–ª—É—á–µ–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∏ —Ç—Ä–∞—Ñ—ñ–∫—É –ø–æ —Ñ–æ—Ä–º—É–ª—ñ</u>: 
    
    ‚Ä¢  –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∫—É—Ä—Å –∑ 5 —É—Ä–æ–∫—ñ–≤ üëâüèª –≤–∏–¥–∞—î–º–æ –∑–∞ —Ä–µ–ø–æ—Å—Ç 
    ‚Ä¢  —Ä–æ–±–æ—Ç –Ω–∞–¥—Å–∏–ª–∞—î —É—Ä–æ–∫–∏ —É —Ç–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª
    ‚Ä¢  –ø–æ–∫—É–ø–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É. 
    
    <strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> 150.000 –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ Reels üëâüèª 1500 —Ä–µ–ø–æ—Å—Ç—ñ–≤ üëâüèª 3-5 –æ–ø–ª–∞—Ç –∫–æ–∂–µ–Ω –¥–µ–Ω—å –≤—ñ–¥ 85 ‚Ç¨ –¥–æ 145 ‚Ç¨ üí∂
    
    <strong><u>–ú–µ—Ç–æ–¥–∏–∫–∞ –æ–∫—É–ø–∏–ª–∞—Å—è –∑–∞ 1 —Ç–∏–∂–¥–µ–Ω—å.</u></strong>
    
    –ê —Ç–µ–ø–µ—Ä –ø–æ—Ä–∞—Ö—É—î–º–æ: 
    
    ‚Ä¢  3 –æ–ø–ª–∞—Ç–∏ –Ω–∞ –¥–µ–Ω—å –ø–æ 85 ‚Ç¨ ‚Äî –Ω–∞ —Ä—ñ–∫ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ 93.075 ‚Ç¨
    ‚Ä¢  1 –æ–ø–ª–∞—Ç–∞ –Ω–∞ 145 ‚Ç¨ ‚Äî –Ω–∞ —Ä—ñ–∫ –¥–∞—î 52.925 ‚Ç¨
    ‚Ä¢  52.925 + 93.075 = 146.000 ‚Ç¨ –Ω–∞ —Ä—ñ–∫ –ø—Ä–∏ –∑–∞—Ç—Ä–∞—Ç–∞—Ö –Ω–∞ –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è –≤—ñ–¥ 1.000‚Ç¨ –Ω–∞ –º—ñ—Å—è—Ü—å.
    """
        media[0].parse_mode = "HTML"  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HTML —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è

        # –ù–∞–¥—Å–∏–ª–∞—î–º–æ –º–µ–¥—ñ–∞-–≥—Ä—É–ø—É
        await bot.send_media_group(chat_id=chat_id, media=media)

        # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        await bot.send_message(
            chat_id=chat_id,
            text="–î–∞–≤–∞–π—Ç–µ –Ω–∞–ª–∞—à—Ç—É—é –í–∞–º —Ç–∞–∫ —Å–∞–º–æ? –ü–∏—à—ñ—Ç—å üëáüèºüëáüèºüëáüèº",
            reply_markup=order  # –≤–∞—à–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ InlineKeyboardMarkup –∞–±–æ —ñ–Ω—à–∞
        )
        add_or_update_user(chat_id, username, "5", 0)

        await asyncio.sleep(36000)
        message1 = """–•–æ—á–µ—à —Å—Ç–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä—Ç–æ–º, –ø—Ä–æ–¥–∞–≤–∞—Ç–∏ –≤ –Ü–Ω—Å—Ç–∞–≥—Ä–∞–º, –∞–ª–µ —É —Ç–µ–±–µ ‚ùå<strong>–Ω–µ–º–∞—î –ø—Ä–æ–¥—É–∫—Ç—É?</strong> ‚ùóÔ∏è
    
    üü¢ <strong>–Ø –Ω–∞–¥–∞—é –≥–æ—Ç–æ–≤–∏–π –ø—Ä–æ–¥—É–∫—Ç, —è–∫ —É –º–µ–Ω–µ!</strong> ‚úÖüòä
    
    <a href="https://knowhowads.com/">Knowhowads.com</a>"""

        message2 = """–£ Instagram –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ 2 –º—ñ–ª—å—è—Ä–¥–∏ –ª—é–¥–µ–π —Ç–∞ 200 –º—ñ–ª—å–π–æ–Ω—ñ–≤ –∫–æ–º–ø–∞–Ω—ñ–π.
    
    –í Instagram 1.28 –º—ñ–ª—å—è—Ä–¥–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —â–æ–º—ñ—Å—è—Ü—è, —ñ –æ—á—ñ–∫—É—î—Ç—å—Å—è, —â–æ –¥–æ 2040 —Ä–æ–∫—É —Ä—ñ—á–Ω–∏–π –æ–±—Å—è–≥ –ø—Ä–æ–¥–∞–∂—É —Ä–µ–∫–ª–∞–º–∏ –¥–æ—Å—è–≥–Ω–µ –±–ª–∏–∑—å–∫–æ 2023 –º—ñ–ª—å—è—Ä–¥—ñ–≤ –¥–æ–ª–∞—Ä—ñ–≤.
    
    –¢—ñ–ª—å–∫–∏ 5% –∫–æ–º–µ—Ä—Ü—ñ–π–Ω–∏—Ö –∞–∫–∞—É–Ω—Ç—ñ–≤ –∑–∞—Ä–∞–∑ –º–∞—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç, —è–∫–∏–π –º–æ–∂–µ —Ä–æ–∑–ø–æ–≤—ñ—Å—Ç–∏ —Ç–∞ –ø–æ–∫–∞–∑–∞—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è –≤ Instagram, —Å—Ç–∞–Ω–µ –Ω–∞–π–±—ñ–ª—å—à –∑–∞—Ç—Ä–µ–±—É–≤–∞–Ω–∏–º —ñ –∑–∞–≤–∞–ª–µ–Ω–∏–º —Ä–æ–±–æ—Ç–æ—é.
    
    –°–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç –º–æ–∂–µ —à—É–∫–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑–∞ –º–æ—î—é –º–µ—Ç–æ–¥–∏–∫–æ—é –ø—Ä—è–º–æ –≤ Instagram —ñ <b>–ø—Ä–æ–¥–∞–≤–∞—Ç–∏ –ø–æ—Å–ª—É–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –ø–æ 1000$ - 2000$.</b>
    
    <u>–õ–∏—à–µ <strong>4 –∫–ª—ñ—î–Ω—Ç–∏</strong> –Ω–∞ –º—ñ—Å—è—Ü—å –º–æ–∂—É—Ç—å –ø—Ä–∏–Ω–µ—Å—Ç–∏ –≤–∞–º <strong>8000$ –≤—Ö—ñ–¥–Ω–∏—Ö –æ–ø–ª–∞—Ç</strong>.</u>
    
    <strong>–ú–æ—è —Å–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞—î:</strong>
    
    ‚Ä¢ –ü–∞–∫–µ—Ç –ø—Ä–æ–¥—É–º–∞–Ω–∏—Ö –ø–æ—Å–ª—É–≥  
    ‚Ä¢ –ê—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–Ω—É –º–∞—Ç—Ä–∏—Ü—é  
    ‚Ä¢ –ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—é —Ç—Ä–∞—Ñ—ñ–∫—É  
    ‚Ä¢ –°–∞–π—Ç –ø—ñ–¥ –í–∞—Å, —è–∫ –µ–∫—Å–ø–µ—Ä—Ç–∞  
    ‚Ä¢ –Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è  
    ‚Ä¢ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–ª–∞—Ç—ñ–∂–Ω–∏—Ö —Å–∏—Å—Ç–µ–º  
    ‚Ä¢ –ü—ñ–¥—Ä—è–¥ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤, <strong>–¥–æ—Å—Ç—É–ø –¥–æ –º–æ—î—ó –≥–æ—Ç–æ–≤–æ—ó –∫–æ–º–∞–Ω–¥–∏</strong>
    
    <strong>–ì–æ—Ç–æ–≤–∏–π –±—ñ–∑–Ω–µ—Å –∑–∞ –º–æ—î—é —Å–∏—Å—Ç–µ–º–æ—é –¥–æ–ø–æ–º–æ–∂–µ –≤–∞–º:</strong>
    
    ‚Ä¢ –û–≤–æ–ª—ñ—Ç–∏ —Å–ø—Ä–∞–≤–æ—é, —è–∫–∞ –¥—ñ–π—Å–Ω–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –≥—Ä–æ—à—ñ  
    ‚Ä¢ –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –≤–∏–≥–ª—è–¥—ñ –¥–æ–ª–∞—Ä—ñ–≤ —ñ —î–≤—Ä–æ. üíµüí∂  
    ‚Ä¢ –î–æ–ø–æ–º–æ–≥—É —Ç–∞ –≤–µ–¥–µ–Ω–Ω—è –≤–∞—à–æ–≥–æ –∑–∞–ø—É—Å–∫—É –¥–æ –ø–µ—Ä—à–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞!
    
    –í—Å–µ —Ü–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–µ –ø—ñ–¥ –∫–ª—é—á + —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É —è –Ω–∞–¥–∞—é <strong>–∑–∞ 2.000$</strong>
    
    –Ñ —Ä–æ–∑—Å—Ç—Ä–æ—á–∫–∞ –≤—ñ–¥ 7 –±–∞–Ω–∫—ñ–≤ –£–∫—Ä–∞—ó–Ω–∏ –¥–æ 25 –ø–ª–∞—Ç–µ–∂—ñ–≤.
    
    –ü–∏—à—ñ—Ç—å —Å–∫–æ—Ä—ñ—à–µ –º–µ–Ω—ñ  
    üëáüèºüëáüèºüëáüèº"""

        await bot.send_message(chat_id, message1, parse_mode="HTML")
        await bot.send_message(chat_id, message2, parse_mode="HTML", reply_markup=order)
    except TelegramAPIError.Forbidden:
        mark_user_blocked(chat_id)
